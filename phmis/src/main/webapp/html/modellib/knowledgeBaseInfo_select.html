<!DOCTYPE html>
<html>
  <head>
    <title>knowledgeBaseInfo编辑</title>
	
    <meta name="keywords" content="keyword1,keyword2,keyword3">
    <meta name="description" content="this is my page">
    <meta name="content-type" content="text/html; charset=UTF-8"> 
		<link href="/static/ace/css/bootstrap.min1.css" rel="stylesheet"> 
		<link rel="stylesheet" href="/assets/css/font-awesome.min.css" /> 
		<!--[if IE 7]>
		  <link rel="stylesheet" href="/assets/css/font-awesome-ie7.min.css" />
		<![endif]-->
		<!-- page specific plugin styles -->
		<link rel="stylesheet" href="/assets/css/jquery-ui-1.10.3.full.min.css" />
		<link rel="stylesheet" href="/assets/css/datepicker.css" />
		<link rel="stylesheet" href="/assets/css/ui.jqgrid.css" /> 
		<!-- ace styles -->
		<link rel="stylesheet" href="/assets/css/ace.min.css" />
		<link rel="stylesheet" href="/assets/css/ace-rtl.min.css" />
		<link rel="stylesheet" href="/assets/css/ace-skins.min.css" />
		<!--[if lte IE 8]>
		  <link rel="stylesheet" href="/assets/css/ace-ie.min.css" />
		<![endif]-->
		<!-- inline styles related to this page -->
		<!-- ace settings handler -->
		<script src="/assets/js/ace-extra.min.js"></script>
		<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!--[if lt IE 9]>
		<script src="/assets/js/html5shiv.js"></script>
		<script src="/assets/js/respond.min.js"></script>
		<![endif]-->		
		<!-- basic scripts -->
	 	<script src="/static/js/util.js"></script>
		<script type="text/javascript">
			window.jQuery || document.write("<script src='/assets/js/jquery-2.0.3.min.js'>"+"<"+"/script>");
		</script> 
		<script type="text/javascript">
			 window.jQuery || document.write("<script src='/assets/js/jquery-1.10.2.min.js'>"+"<"+"/script>");
		</script> 
		<script type="text/javascript">
			if("ontouchend" in document) document.write("<script src='/assets/js/jquery.mobile.custom.min.js'>"+"<"+"/script>");
		</script>
		<script src="/assets/js/bootstrap.min.js"></script>
		<script src="/assets/js/typeahead-bs2.min.js"></script>
		<!-- page specific plugin scripts -->
		<script src="/assets/js/date-time/bootstrap-datepicker.min.js"></script>
		<script src="/assets/js/jqGrid/jquery.jqGrid.min.js"></script>
		<script src="/assets/js/jqGrid/i18n/grid.locale-cn.js"></script> 
		<!-- ace scripts --> 
		<script src="/assets/js/ace-elements.min.js"></script>
		<script src="/assets/js/ace.min.js"></script>
	    <script type="text/javascript" src="/plugins/layer/3.0/layer.js"></script>
		<link href="/static/ace/js/sweetalert/sweetalert.css" rel="stylesheet">     
		<script src="/static/ace/js/sweetalert/sweetalert.min.js"></script>
		<!-- inline scripts related to this page -->
	    <script src="/static/ace/js/bootstrap-datetimepicker.js"></script>
		<script src="/static/ace/js/bootstrap-datetimepicker.zh-CN.js"></script> 
 		<link rel="stylesheet" href="/assets/css/common.css" />
 			<style>
	body {
		background: #fff;
		margin: 0;
		font-size: 18;
		width: 99%;
		padding: 0px 2px 0px;
	}
	</style> 
  </head>
 <body> 
 <div id="gsearch" style="display:none;" title="查询窗口">  
  <form role="form"  name="searchForm" action="" method="POST" class="form-inline">
  <table id="table_report" class="table table-striped table-bordered table-hover" style="width:100%;align:center"> 		
        <tr>								
		<td style="width:110px;text-align: right;padding-top: 13px;">
			<span class="label label-success arrowed">知识名称：</span>
		</td>
		<td class="controlcontent" >
			<input  type="text" id="knowledgeName" placeholder="这里输入知识名称"  class='form-control'  style="width:98%;" name="knowledgeName" autocomplete="off" />
	  	</td>			
	   </tr> 	 					  
        <tr>								
		<td style="width:110px;text-align: right;padding-top: 13px;">
			<span class="label label-success arrowed">功能类型：</span>
		</td>
		<td class="controlcontent" >
<select class="form-control"   name="phmfunctionTypeId" id=phmfunctionTypeId data-placeholder="请选择省份"   title="省份" style="width:98%;" >
							  				<option  value=''>请选择</option> 
										</select>	  	</td>			
	   </tr> 	 					  
        <tr>								
		<td style="width:110px;text-align: right;padding-top: 13px;">
			<span class="label label-success arrowed">雷达类型：</span>
		</td>
		<td class="controlcontent" >
<select class="form-control"   name="radarTypeId" id=radarTypeId data-placeholder="请选择省份"   title="省份" style="width:98%;" >
							  				<option  value=''>请选择</option> 
										</select>	  	</td>			
	   </tr> 	 					  
        <tr>								
		<td style="width:110px;text-align: right;padding-top: 13px;">
			<span class="label label-success arrowed">子系统类型：</span>
		</td>
		<td class="controlcontent" >
<select class="form-control"   name="subsystemTypeId" id=subsystemTypeId data-placeholder="请选择省份"   title="省份" style="width:98%;" >
							  				<option  value=''>请选择</option> 
										</select>	  	</td>			
	   </tr> 	 					  
        <tr>								
		<td style="width:110px;text-align: right;padding-top: 13px;">
			<span class="label label-success arrowed">关重件类型：</span>
		</td>
		<td class="controlcontent" >
<select class="form-control"   name="moduleId" id=moduleId data-placeholder="请选择省份"   title="省份" style="width:98%;" >
							  				<option  value=''>请选择</option> 
										</select>	  	</td>			
	   </tr> 	 					  
        <tr>								
		<td style="width:110px;text-align: right;padding-top: 13px;">
			<span class="label label-success arrowed">key：</span>
		</td>
		<td class="controlcontent" >
			<input  type="text" id="key" placeholder="这里输入key"  class='form-control'  style="width:98%;" name="key" autocomplete="off" />
	  	</td>			
	   </tr> 	 					  
        <tr>								
		<td style="width:110px;text-align: right;padding-top: 13px;">
			<span class="label label-success arrowed">value：</span>
		</td>
		<td class="controlcontent" >
			<input  type="text" id="value" placeholder="这里输入value"  class='form-control'  style="width:98%;" name="value" autocomplete="off" />
	  	</td>			
	   </tr> 	 					  

	</table>
</form> 
</div>
 
				 <table id="list2"></table>   
				  <div id="pager2"></div>  
 </body>
  <script type="text/javascript">
	$(top.hangge());
	$(function(){
       pageInit();
    }); 
	///='++"&radarId="+radarId+"&phmsubsId="+phmsubsId+"&moduleId=
		
    
	
    function pageInit(){ 
       var pageHeaderHeight =$(window).height()-88; 
       var postData={  
		  'knowledgeName':$('#knowledgeName').val(),
		  'phmfunctionTypeId':getParamer("phmfunctionTypeId"),
		  'radarTypeId':$('#radarTypeId').val(),
		  'subsystemTypeId':$('#subsystemTypeId').val(),
		  'moduleId':$('#moduleId').val(),
		  'key':$('#key').val(),
		  'value':$('#value').val(),
		  'radarId':getParamer("radarId"),
		  'phmsubsId':getParamer("phmsubsId"),
		  'radarModuleId':getParamer("moduleId"),

		  'fromMenu':"2" 
	   };
      jQuery("#list2").jqGrid(
      {
        url : '/knowledgeBaseInfo/listSelect',
        width : $(window).width()-20, 
		multiselect : true, 
		altRows:true,  
		rownumbers :true,
		height:pageHeaderHeight, 
        datatype : "json",
        ///caption:"<span class=\"glyphicon glyphicon-list\"></span>列表信息 ", 
        styleUI: 'Bootstrap',//设置jqgrid的全局样式为bootstrap样式  
        shrinkToFit: true,
        colNames :[
	    			'<span class="glyphicon glyphicon-list-alt"></span>知识编号',
	    			'知识名称',
	    			'功能类型编号',
	    			'雷达类型',
	    			'子系统类型',
	    			'关重件类型',
	    			'key',
	    			'value',
 
	    		   ],
        colModel :  [  
        			{name : 'id',index : 'id',sortable:true},
					{name : 'knowledgeName',index : 'knowledgeName',sortable:true},
					{name : 'phmfunctionTypeInfo.phmfunctionTypeName',index : 'phmfunctionTypeId',sortable:true},
					{name : 'radarTypeInfo.radarTypeName',index : 'radarTypeId',sortable:true},
					{name : 'subsystemInfo.subsystemName',index : 'subsystemTypeId',sortable:true},
					{name : 'moduleTypeInfo.pname',index : 'moduleId',sortable:true},
					{name : 'key',index : 'key',sortable:true},
					{name : 'value',index : 'value',sortable:true} 
	               ],
        rowNum : 10,
        rowList : [ 10, 20, 30 ],
        pager : '#pager2',
        sortname : 'id',
        postData:postData, //发送数据
        mtype : "post",
        viewrecords : true, 
        //toolbar: [true, "top"],
        loadComplete:function(){
        	var table = this;
			setTimeout(function(){
				styleCheckbox(table);							
				updateActionIcons(table);
				updatePagerIcons(table);
				enableTooltips(table);
			}, 0);
        	init();
        }             
      });
      $("#t_list2").css({"background-color":"","height":"40px"});
      jQuery("#list2").jqGrid('navGrid', '#pager2', {edit :false,add : false,del : false,search:false});
	}  

	function queryList() {
	  var postData={  
		  'knowledgeName':$('#knowledgeName').val(),
		  'phmfunctionTypeId':$('#phmfunctionTypeId').val(),
		  'radarTypeId':$('#radarTypeId').val(),
		  'subsystemTypeId':$('#subsystemTypeId').val(),
		  'moduleId':$('#moduleId').val(),
		  'key':$('#key').val(),
		  'value':$('#value').val(),

		  'fromMenu':"2" 
	   };
	  $("#list2").jqGrid('setGridParam',{  
	          postData:postData, //发送数据 
	          datatype:'json',  
	          page:1 
	      }).trigger("reloadGrid"); //重新载入  
	}
  </script>
  
  <script type="text/javascript"> 
		//检索
		function gsearch(){ 	
	     layer.open({
			 	 type: 1, 
			 	 title:'<span class=\"glyphicon glyphicon-list\"></span>筛选条件',
			 	 closeBtn: 1,
			 	 offset: 'auto', 
				 content: $("#gsearch"),
				 btn: [' <span class="glyphicon glyphicon-search"></span>查询','<span class="glyphicon glyphicon-remove"></span>取消'],
			     area: ['500px'],
				 maxmin: true,
      			 shadeClose: true, //点击遮罩关闭层
				 yes: function(index, layero){ 
				 	queryList();
					layer.close(index);
				}, 
				no: function(index){ 
					layer.close(index);
				} 
	       });  
		} 
		//新增
		function add(){
		 layer.open({
		 	type: 2, 
		 	closeBtn: 1,
		 	title:'<span class="glyphicon glyphicon-import"></span>信息编辑',
		 	offset: 'auto',
		 	area: ['800px', '480px'],
			content: '/html/modellib/knowledgeBaseInfo_edit.html', 
			shadeClose: false,
		    maxmin: true,
			yes: function(index, layero){  
			}, 
			no: function(index){ 
				layer.close(index);
			}
		  }); 
		} 
		//修改
		function edit(Id){
			layer.open({
			 	type: 2, 
			 	closeBtn: 1,
			 	title:'<span class="glyphicon glyphicon-import"></span>信息编辑',
			 	offset: 'auto',
			 	area: ['800px', '480px'],
				content: '/html/modellib/knowledgeBaseInfo_edit.html?id='+Id, 
				shadeClose: false,
			    maxmin: true,
				yes: function(index, layero){  
				}, 
				no: function(index){ 
					layer.close(index);
				}
			  });  
		}
		///删除
		function del(Id){
		  swal({
                title: "您确定要删除这条信息吗",
                text: "删除后将无法恢复，请谨慎操作！",
                type: "warning",
                showCancelButton: true,
                confirmButtonColor: "#DD6B55",
                confirmButtonText: "是的，我要删除！",
                cancelButtonText: "让我再考虑一下…",
                closeOnConfirm: false,
                closeOnCancel: false
            }, function (isConfirm) {
                if (isConfirm) {
                var url = "/knowledgeBaseInfo/delete/"+Id;
					$.get(url,function(data){
						if("success" == data.result){	
						    swal("删除成功！", "您已经永久删除了这条信息。", "success")					    
							queryList();
						}else if("false" == data.result){
							top.hangge();
							swal("删除失败！", "删除这条信息失败。", "error")		
						}
					});
                   
                } else {
                    swal("已取消", "您取消了删除操作！", "error")
                }
            })
	  
			     
		}
		//信息查看
		function view(Id){
			layer.open({
			 	type: 2, 
			 	closeBtn: 1,
			 	title:'<span class="glyphicon glyphicon-import"></span>信息编辑',
			 	offset: 'auto',
			 	area: ['800px', '480px'],
				content: '/html/modellib/knowledgeBaseInfo_view.html?id='+Id, 
				shadeClose: false,
			    maxmin: true,
			    btn: ['<span class="glyphicon glyphicon-remove"></span>取消'],
				yes: function(index, layero){ 
					layer.close(index); 
				}, 
				no: function(index){ 
					layer.close(index);
				}
			  });   
		}
		 
		function init(){ 
		 $.ajax({
				type: "GET",
				url: '/knowledgeBaseInfo/getAll', 
				dataType:'json',
				cache: false,
				success: function(data){
				  //  alert(data);
					if(data && data!=""){  
					    $("#phmfunctionTypeId").html("");
				        $("#phmfunctionTypeId").append('<option value="">请选择</option>');
						$.each(data.phmfunctionTypeInfos,function(i,item){  	 
						     //  alert(item.id);  
						      	$("#phmfunctionTypeId").append("<option  value='"+item.id+"'>"+item.phmfunctionTypeName+"</option>");	 
					      　});      
					      
					    $("#radarTypeId").html("");
				        $("#radarTypeId").append('<option value="">请选择</option>');
						$.each(data.radarTypeInfos,function(i,item){  	 
						     //  alert(item.id);  
						      	$("#radarTypeId").append("<option  value='"+item.id+"'>"+item.radarTypeName+"</option>");	 
					      　});      
					      
					   $("#subsystemTypeId").html("");
				        $("#subsystemTypeId").append('<option value="">请选择</option>');
						$.each(data.subsystemInfos,function(i,item){  	 
						     //  alert(item.id);  
						      	$("#subsystemTypeId").append("<option  value='"+item.id+"'>"+item.subsystemName+"</option>");	 
					      　});      
					   $("#moduleId").html("");
				        $("#moduleId").append('<option value="">请选择</option>');
				        debugger
						$.each(data.moduleTypeInfos,function(i,item){  	 
						     //  alert(item.id);  
						      	$("#moduleId").append("<option  value='"+item.id+"'>"+item.pname+"</option>");	 
					      　});    
					   	     
				    } 
				 }
			   });
		   
		  　 $.ajax({
				type: "GET",
				url: '/knowledgeBaseInfo/getMenuFun?menuId='+getParamer("menuId"), 
				dataType:'json',
				cache: false,
				success: function(data){ 
					if(data && data!=""){  
						$.each(data,function(i,item){  	
		                      $("[id^='"+item.btnCode+"']").show();		
						　　});
						 
					     
				    } 
				 }
			   });
		}  
		
		
		var rowArray=new Array();
		function getRowData(){
		
			var ids=$('#list2').jqGrid('getGridParam','selarrrow');
			$.each(ids, function(i, item) {
				var data=new Object();
				var rowData = $("#list2").jqGrid('getRowData',item);  
				rowArray[i]=rowData;
			})
			return {rowArray:rowArray};
		}
	</script> 

</body>
</html>
