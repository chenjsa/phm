<!DOCTYPE html>
<html>
  <head>
    <title>userContactInfo编辑</title>
	
    <meta name="keywords" content="keyword1,keyword2,keyword3">
    <meta name="description" content="this is my page">
    <meta name="content-type" content="text/html; charset=UTF-8"> 
		<link href="/static/ace/css/bootstrap.min1.css" rel="stylesheet"> 
		<link rel="stylesheet" href="/assets/css/font-awesome.min.css" /> 
		<!--[if IE 7]>
		  <link rel="stylesheet" href="/assets/css/font-awesome-ie7.min.css" />
		<![endif]-->
		<!-- page specific plugin styles -->
		<link rel="stylesheet" href="/assets/css/jquery-ui-1.10.3.full.min.css" />
		<link rel="stylesheet" href="/assets/css/datepicker.css" />
		<link rel="stylesheet" href="/assets/css/ui.jqgrid.css" /> 
		<!-- ace styles -->
		<link rel="stylesheet" href="/assets/css/ace.min.css" />
		<link rel="stylesheet" href="/assets/css/ace-rtl.min.css" />
		<link rel="stylesheet" href="/assets/css/ace-skins.min.css" />
		<!--[if lte IE 8]>
		  <link rel="stylesheet" href="/assets/css/ace-ie.min.css" />
		<![endif]-->
		<!-- inline styles related to this page -->
		<!-- ace settings handler -->
		<script src="/assets/js/ace-extra.min.js"></script>
		<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!--[if lt IE 9]>
		<script src="/assets/js/html5shiv.js"></script>
		<script src="/assets/js/respond.min.js"></script>
		<![endif]-->		
		<!-- basic scripts -->
	 	<script src="/static/js/util.js"></script>
		<script type="text/javascript">
			window.jQuery || document.write("<script src='/assets/js/jquery-2.0.3.min.js'>"+"<"+"/script>");
		</script> 
		<script type="text/javascript">
			 window.jQuery || document.write("<script src='/assets/js/jquery-1.10.2.min.js'>"+"<"+"/script>");
		</script> 
		<script type="text/javascript">
			if("ontouchend" in document) document.write("<script src='/assets/js/jquery.mobile.custom.min.js'>"+"<"+"/script>");
		</script>
		<script src="/assets/js/bootstrap.min.js"></script>
		<script src="/assets/js/typeahead-bs2.min.js"></script>
		<!-- page specific plugin scripts -->
		<script src="/assets/js/date-time/bootstrap-datepicker.min.js"></script>
		<script src="/assets/js/jqGrid/jquery.jqGrid.min.js"></script>
		<script src="/assets/js/jqGrid/i18n/grid.locale-cn.js"></script> 
		<!-- ace scripts --> 
		<script src="/assets/js/ace-elements.min.js"></script>
		<script src="/assets/js/ace.min.js"></script>
	    <script type="text/javascript" src="/plugins/layer/3.0/layer.js"></script>
		<link href="/static/ace/js/sweetalert/sweetalert.css" rel="stylesheet">     
		<script src="/static/ace/js/sweetalert/sweetalert.min.js"></script>
		<!-- inline scripts related to this page -->
	    <script src="/static/ace/js/bootstrap-datetimepicker.js"></script>
		<script src="/static/ace/js/bootstrap-datetimepicker.zh-CN.js"></script> 
 		<link rel="stylesheet" href="/assets/css/common.css" />
  </head>
 <body> 
 <div id="gsearch" style="display:none;" title="查询窗口">  
  <form role="form"  name="searchForm" action="" method="POST" class="form-inline">
  <table id="table_report" class="table table-striped table-bordered table-hover" style="width:100%;align:center"> 		
        <tr>								
		<td style="width:110px;text-align: right;padding-top: 13px;">
			<span class="label label-success arrowed">contact_id：</span>
		</td>
		<td class="controlcontent" >
			<input  type="text" id="contactId" placeholder="这里输入contact_id"  class='form-control'  style="width:98%;" name="contactId" autocomplete="off" />
	  	</td>			
	   </tr> 	 					  
        <tr>								
		<td style="width:110px;text-align: right;padding-top: 13px;">
			<span class="label label-success arrowed">user_id：</span>
		</td>
		<td class="controlcontent" >
			<input  type="text" id="userId" placeholder="这里输入user_id"  class='form-control'  style="width:98%;" name="userId" autocomplete="off" />
	  	</td>			
	   </tr> 	 					  
        <tr>								
		<td style="width:110px;text-align: right;padding-top: 13px;">
			<span class="label label-success arrowed">no：</span>
		</td>
		<td class="controlcontent" >
			<input  type="text" id="no" placeholder="这里输入no"  class='form-control'  style="width:98%;" name="no" autocomplete="off" />
	  	</td>			
	   </tr> 	 					  
        <tr>								
		<td style="width:110px;text-align: right;padding-top: 13px;">
			<span class="label label-success arrowed">other：</span>
		</td>
		<td class="controlcontent" >
			<input  type="text" id="other" placeholder="这里输入other"  class='form-control'  style="width:98%;" name="other" autocomplete="off" />
	  	</td>			
	   </tr> 	 					  

	</table>
</form> 
</div>
<div class="widget-container-span">
	<div class="widget-box" style="width:100%;">
		<div class="widget-header">
			<h5> <span class="glyphicon glyphicon-book"></span>信息维护</h4>
			<div class="widget-toolbar">
				<a href="#" data-action="reload">
					<i class="icon-refresh"></i>
				</a>

				<a href="#" data-action="collapse">
					<i class="icon-chevron-up"></i>
				</a>
			</div>			
			<div class="widget-toolbar"> 
				  <button type="button"  id="gsearch"  onclick="gsearch();" class="btn btn-xs btn-success">
					<span class="glyphicon glyphicon-search"></span> 查询
				  </button>
			</div>
			<div class="widget-toolbar">
				<button type="button" id="goAdd"  onclick='add();'  style="display:none" class="btn btn-xs btn-warning">  
					<span class="glyphicon glyphicon-export"></span>新增
				</button>
			</div>			 
		</div>
		<div class="widget-body">			 
			<div class="widget-main">
				 <table id="list2"></table> 
				 <div id="pager2"></div>  
			</div>
		</div>
	</div>
</div> 
 </body>
  <script type="text/javascript">
	$(top.hangge());
	$(function(){
       pageInit();
    }); 
    
    function pageInit(){ 
       var pageHeaderHeight =$(window).height()-178; 
       var postData={  
		  'contactId':$('#contactId').val(),
		  'userId':$('#userId').val(),
		  'no':$('#no').val(),
		  'other':$('#other').val(),

		  'fromMenu':"2" 
	   };
      jQuery("#list2").jqGrid(
      {
        url : '/userContactInfo/list',
        width : $(window).width()-20, 
		multiselect : true, 
		multiboxonly:true,  
		 altRows: true,
		rownumbers :true,
		height:pageHeaderHeight, 
        datatype : "json",
        caption:"<span class=\"glyphicon glyphicon-list\"></span>列表信息 ", 
        styleUI: 'Bootstrap',//设置jqgrid的全局样式为bootstrap样式  
        shrinkToFit: true,
        colNames :[
	    			'<span class="glyphicon glyphicon-list-alt"></span>contact_id',
	    			'<span class="glyphicon glyphicon-list-alt"></span>user_id',
	    			'<span class="glyphicon glyphicon-list-alt"></span>no',
	    			'<span class="glyphicon glyphicon-list-alt"></span>other',

	    			'<span class="glyphicon glyphicon-check"></span>操作'
	    		   ],
        colModel :  [  
					{name : 'contactId',index : 'contactId',sortable:true},
					{name : 'userId',index : 'userId',sortable:true},
					{name : 'no',index : 'no',sortable:true},
					{name : 'other',index : 'other',sortable:true},

	                {
						name : "id",
						index : "id",
						align : "center",
						sortable : false,
						formatter :function(value, options, rData) {     
			         		  var html="<a id='goView-"+value+"'  style='display:none' class='btn btn-xs btn-success' title='查看' onclick=view('"+value+"');><i class='glyphicon glyphicon-search' title='查看'></i></a>";
			          	 	  html=html+"&nbsp;&nbsp;<a id='goEdit-"+value+"'  style='display:none' class='btn btn-xs btn-success' title='修改' onclick=edit('"+value+"');><i class='glyphicon glyphicon-log-out' title='修改'></i></a>";
			          	 	  html=html+"&nbsp;&nbsp;<a id='delete-"+value+"'  style='display:none' class='btn btn-xs btn-danger' title='删除' onclick=del('"+value+"');><i class='glyphicon glyphicon-remove' title='删除'></i></a>";
			          	 	  return html; 
			           }     	   
					}
	               ],
        rowNum : 10,
        rowList : [ 10, 20, 30 ],
        pager : '#pager2',
        sortname : 'id',
        postData:postData, //发送数据
        mtype : "post",
        viewrecords : true, 
        //toolbar: [true, "top"],
        loadComplete:function(){
        	var table = this;
			setTimeout(function(){
				styleCheckbox(table);							
				updateActionIcons(table);
				updatePagerIcons(table);
				enableTooltips(table);
			}, 0);
        	init();
        }             
      });
      $("#t_list2").css({"background-color":"","height":"40px"});
      jQuery("#list2").jqGrid('navGrid', '#pager2', {edit :false,add : false,del : false,search:false});
	}  

	function queryList() {
	  var postData={  
		  'contactId':$('#contactId').val(),
		  'userId':$('#userId').val(),
		  'no':$('#no').val(),
		  'other':$('#other').val(),

		  'fromMenu':"2" 
	   };
	  $("#list2").jqGrid('setGridParam',{  
	          postData:postData, //发送数据 
	          datatype:'json',  
	          page:1 
	      }).trigger("reloadGrid"); //重新载入  
	}
  </script>
  
  <script type="text/javascript"> 
		//检索
		function gsearch(){ 	
	     layer.open({
			 	 type: 1, 
			 	 title:'<span class=\"glyphicon glyphicon-list\"></span>筛选条件',
			 	 closeBtn: 1,
			 	 offset: 'auto', 
				 content: $("#gsearch"),
				 btn: [' <span class="glyphicon glyphicon-search"></span>查询','<span class="glyphicon glyphicon-remove"></span>取消'],
			     area: ['500px'],
				 maxmin: true,
      			 shadeClose: true, //点击遮罩关闭层
				 yes: function(index, layero){ 
				 	queryList();
					layer.close(index);
				}, 
				no: function(index){ 
					layer.close(index);
				} 
	       });  
		} 
		//新增
		function add(){
		 layer.open({
		 	type: 2, 
		 	closeBtn: 1,
		 	title:'<span class="glyphicon glyphicon-import"></span>信息编辑',
		 	offset: 'auto',
		 	area: ['800px', '480px'],
			content: '/html/userContactInfo/userContactInfo_edit.html', 
			shadeClose: false,
		    maxmin: true,
			yes: function(index, layero){  
			}, 
			no: function(index){ 
				layer.close(index);
			}
		  }); 
		} 
		//修改
		function edit(Id){
			layer.open({
			 	type: 2, 
			 	closeBtn: 1,
			 	title:'<span class="glyphicon glyphicon-import"></span>信息编辑',
			 	offset: 'auto',
			 	area: ['800px', '480px'],
				content: '/html/userContactInfo/userContactInfo_edit.html?id='+Id, 
				shadeClose: false,
			    maxmin: true,
				yes: function(index, layero){  
				}, 
				no: function(index){ 
					layer.close(index);
				}
			  });  
		}
		///删除
		function del(Id){
		  swal({
                title: "您确定要删除这条信息吗",
                text: "删除后将无法恢复，请谨慎操作！",
                type: "warning",
                showCancelButton: true,
                confirmButtonColor: "#DD6B55",
                confirmButtonText: "是的，我要删除！",
                cancelButtonText: "让我再考虑一下…",
                closeOnConfirm: false,
                closeOnCancel: false
            }, function (isConfirm) {
                if (isConfirm) {
                var url = "/userContactInfo/delete/"+Id;
					$.get(url,function(data){
						if("success" == data.result){	
						    swal("删除成功！", "您已经永久删除了这条信息。", "success")					    
							queryList();
						}else if("false" == data.result){
							top.hangge();
							swal("删除失败！", "删除这条信息失败。", "error")		
						}
					});
                   
                } else {
                    swal("已取消", "您取消了删除操作！", "error")
                }
            })
	  
			     
		}
		//信息查看
		function view(Id){
			layer.open({
			 	type: 2, 
			 	closeBtn: 1,
			 	title:'<span class="glyphicon glyphicon-import"></span>信息编辑',
			 	offset: 'auto',
			 	area: ['800px', '480px'],
				content: '/html/userContactInfo/userContactInfo_view.html?id='+Id, 
				shadeClose: false,
			    maxmin: true,
			    btn: ['<span class="glyphicon glyphicon-remove"></span>取消'],
				yes: function(index, layero){ 
					layer.close(index); 
				}, 
				no: function(index){ 
					layer.close(index);
				}
			  });   
		}
		 
		function init(){ 
		  　 $.ajax({
				type: "GET",
				url: '/userContactInfo/getMenuFun?menuId='+getParamer("menuId"), 
				dataType:'json',
				cache: false,
				success: function(data){ 
					if(data && data!=""){  
						$.each(data,function(i,item){  	
		                      $("[id^='"+item.btnCode+"']").show();		
						　　});
						 
					     
				    } 
				 }
			   });
		}  
	</script> 

</body>
</html>
